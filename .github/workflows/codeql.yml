name: "CodeQL Analysis"

on:
  push:
    branches:
      - main  # Change to your main branch if it's different
  pull_request:
    branches:
      - main  # Change to your main branch if it's different

jobs:
  analyze:
    name: "Run CodeQL Analysis"
    runs-on: ubuntu-latest

    steps:
      # Checkout the repository
      - name: "Checkout code"
        uses: actions/checkout@v3

      # Set up CodeQL
      - name: "Set up CodeQL"
        uses: github/codeql-action/setup-codeql@v2

      # Run CodeQL analysis
      - name: "Run CodeQL analysis"
        uses: github/codeql-action/analyze@v2
        with:
          # The default CodeQL queries are usually sufficient, but you can specify a custom query suite here
          # query-suite: ./path/to/your-query-suite.qls
          
      # Upload CodeQL analysis results
      - name: "Upload CodeQL results"
        uses: github/codeql-action/upload-sarif@v2
        with:
          sarif_file: ${{ github.workspace }}/codeql-results.sarif

      # Example: set up a secret (optional, based on your use case)
      - name: "Set GEN_AI_API_KEY secret for testing"
        run: echo "GEN_AI_API_KEY=${{ secrets.GEN_AI_API_KEY }}" >> $GITHUB_ENV
